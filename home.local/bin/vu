#!/bin/sh

## taken from to run script from keyboard https://askubuntu.com/questions/319400/how-to-run-sh-script-with-keybind
sleep 0.2

# This is a wrapper for vifm to allow ueberzug images.

export FIFO_UEBERZUG="/tmp/vifm-ueberzug-${PPID}"

cleanup() {
    rm "$FIFO_UEBERZUG" 2>/dev/null
    pkill -P $$ 2>/dev/null
}

rm "$FIFO_UEBERZUG" 2>/dev/null
mkfifo "$FIFO_UEBERZUG"
trap cleanup EXIT
tail --follow "$FIFO_UEBERZUG" | ueberzug layer --silent --parser bash &

vifm
cleanup
